# Working with Mongoose

Mongoose is an Object Data Modeling (ODM) library for MongoDB and Node.js. It provides a straightforward way to define schemas and models, and interact with MongoDB using JavaScript.

## Defining Schemas and Models

To work with Mongoose, you first need to define a schema for your MongoDB collection. A schema defines the structure of the documents in the collection, including the fields and their types.

Here's an example of how to define a schema for a user collection:

```javascript
const mongoose = require('mongoose');

const userSchema = new mongoose.Schema({
  name: {
    type: String,
    required: true
  },
  email: {
    type: String,
    required: true,
    unique: true
  },
  age: {
    type: Number,
    default: 0
  }
});

const User = mongoose.model('User', userSchema);

module.exports = User;
```

In this example, we define a user schema with three fields: name, email, and age. The name and email fields are required, and the email field is also set to be unique. The age field has a default value of 0.

We then create a model using the schema and export it for use in other parts of our application.

## Creating and Saving Documents

Once we have defined a model, we can create and save documents in the MongoDB collection.

```javascript
const User = require('./models/User');

const user = new User({
  name: 'John Doe',
  email: 'john@example.com',
  age: 25
});

user.save()
  .then(() => {
    console.log('User saved successfully');
  })
  .catch((error) => {
    console.error('Error saving user:', error);
  });
```

In this example, we create a new user document using the User model and save it to the database using the `save()` method. The `save()` method returns a promise, so we can use `.then()` and `.catch()` to handle the success and error cases respectively.

## Querying Documents

Mongoose provides a rich set of methods for querying documents in MongoDB. Here's an example of how to find all users with a specific age:

```javascript
const User = require('./models/User');

User.find({ age: 25 })
  .then((users) => {
    console.log('Users:', users);
  })
  .catch((error) => {
    console.error('Error querying users:', error);
  });
```

In this example, we use the `find()` method to query the User collection for documents with an age of 25. The `find()` method returns a promise that resolves to an array of matching documents.

## Updating Documents

To update documents in MongoDB, we can use Mongoose's `updateOne()` or `updateMany()` methods. Here's an example of how to update a user's age:

```javascript
const User = require('./models/User');

User.updateOne({ name: 'John Doe' }, { age: 30 })
  .then(() => {
    console.log('User updated successfully');
  })
  .catch((error) => {
    console.error('Error updating user:', error);
  });
```

In this example, we use the `updateOne()` method to update the age of the user with the name 'John Doe' to 30.

## Deleting Documents

To delete documents in MongoDB, we can use Mongoose's `deleteOne()` or `deleteMany()` methods. Here's an example of how to delete a user:

```javascript
const User = require('./models/User');

User.deleteOne({ name: 'John Doe' })
  .then(() => {
    console.log('User deleted successfully');
  })
  .catch((error) => {
    console.error('Error deleting user:', error);
  });
```

In this example, we use the `deleteOne()` method to delete the user with the name 'John Doe'.

## Conclusion

Mongoose provides a powerful and convenient way to work with MongoDB in Node.js applications. It simplifies the process of defining schemas, creating and saving documents, querying and updating data, and much more. With Mongoose, you can leverage the full power of MongoDB while enjoying the benefits of a structured and intuitive API.